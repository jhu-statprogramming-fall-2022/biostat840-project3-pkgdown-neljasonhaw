<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The predictions at level \(i\) are obtained by adding together the
  contributions from the estimated fixed effects and the estimated
  random effects at levels less or equal to \(i\) and evaluating the
  model function at the resulting estimated parameters.  If group values
  not included in the original grouping factors  are present in
  newdata, the corresponding predictions will be  set to
  NA for levels greater or equal to the level at which the
  unknown groups occur."><title>Predictions from an nlme Object — predict.nlme • nlme</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.4/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predictions from an nlme Object — predict.nlme"><meta property="og:description" content="The predictions at level \(i\) are obtained by adding together the
  contributions from the estimated fixed effects and the estimated
  random effects at levels less or equal to \(i\) and evaluating the
  model function at the resulting estimated parameters.  If group values
  not included in the original grouping factors  are present in
  newdata, the corresponding predictions will be  set to
  NA for levels greater or equal to the level at which the
  unknown groups occur."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlme</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-160</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lme-example.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Predictions from an nlme Object</h1>
      
      <div class="d-none name"><code>predict.nlme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The predictions at level \(i\) are obtained by adding together the
  contributions from the estimated fixed effects and the estimated
  random effects at levels less or equal to \(i\) and evaluating the
  model function at the resulting estimated parameters.  If group values
  not included in the original grouping factors  are present in
  <code>newdata</code>, the corresponding predictions will be  set to
  <code>NA</code> for levels greater or equal to the level at which the
  unknown groups occur.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for nlme</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, level <span class="op">=</span> <span class="va">Q</span>, asList <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        na.action <span class="op">=</span> <span class="va">na.fail</span>, naPattern <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an object inheriting from class <code>"<a href="nlme.html">nlme</a>"</code>,
    representing a fitted nonlinear mixed-effects model.</p></dd>

 <dt>newdata</dt>
<dd><p>an optional data frame to be used for obtaining the
   predictions.  All variables used in the nonlinear model, the fixed and
   the random effects models, as well as the grouping factors, must be
   present in the data frame.  If missing, the fitted values are
   returned.</p></dd>

 <dt>level</dt>
<dd><p>an optional integer vector giving the level(s) of grouping
   to be used in obtaining the predictions.  Level values increase from
   outermost to innermost grouping, with level zero corresponding to the
   population predictions.  Defaults to the highest or innermost level of
   grouping (and is <code>object$dims$Q</code>).</p></dd>

 <dt>asList</dt>
<dd><p>an optional logical value.  If <code>TRUE</code> and a single
   value is given in <code>level</code>, the returned object is a list with
   the predictions split by groups; else the returned value is
   either a vector or a data frame, according to the length of
   <code>level</code>.</p></dd>

 <dt>na.action</dt>
<dd><p>a function that indicates what should happen when
   <code>newdata</code> contains <code>NA</code>s.  The default action
   (<code>na.fail</code>) causes the function to print an error message and
   terminate if there are any incomplete observations.</p></dd>

 <dt>naPattern</dt>
<dd><p>an expression or formula object, specifying which returned
   values are to be regarded as missing.</p></dd>

 <dt>...</dt>
<dd><p>some methods for this generic require additional
    arguments.  None are used in this method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>if a single level of grouping is specified in <code>level</code>, the
  returned value is either a list with the predictions split by groups
  (<code>asList = TRUE</code>) or a vector with the predictions
  (<code>asList = FALSE</code>); else, when multiple grouping levels are
  specified in <code>level</code>, the returned object is a data frame with
  columns given by the predictions at different levels and the grouping
  factors.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="nlme.html">nlme</a></code>, <code><a href="fitted.lme.html">fitted.lme</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Loblolly</span><span class="op">)</span> <span class="co"># groupedData  w/  'Seed' is grouping variable :</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Grouped Data: height ~ age | Seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    height age Seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    4.51   3  301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  10.89   5  301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  28.72  10  301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  41.74  15  301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  52.70  20  301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  60.92  25  301</span>
<span class="r-in"><span><span class="co">## Grouped Data: height ~ age | Seed</span></span></span>
<span class="r-in"><span><span class="co">##    height age Seed</span></span></span>
<span class="r-in"><span><span class="co">## 1    4.51   3  301</span></span></span>
<span class="r-in"><span><span class="co">## 15  10.89   5  301</span></span></span>
<span class="r-in"><span><span class="co">## ..  .....   .  ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="nlme.html">nlme</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSasymp.html" class="external-link">SSasymp</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">Asym</span>, <span class="va">R0</span>, <span class="va">lrc</span><span class="op">)</span>,  data <span class="op">=</span> <span class="va">Loblolly</span>,</span></span>
<span class="r-in"><span>            fixed <span class="op">=</span> <span class="va">Asym</span> <span class="op">+</span> <span class="va">R0</span> <span class="op">+</span> <span class="va">lrc</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>            random <span class="op">=</span> <span class="va">Asym</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co">## &lt;---grouping---&gt;  Asym ~ 1 | Seed</span></span></span>
<span class="r-in"><span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Asym <span class="op">=</span> <span class="fl">103</span>, R0 <span class="op">=</span> <span class="op">-</span><span class="fl">8.5</span>, lrc <span class="op">=</span> <span class="op">-</span><span class="fl">3.3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonlinear mixed-effects model fit by maximum likelihood</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: height ~ SSasymp(age, Asym, R0, lrc) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Data: Loblolly </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Log-likelihood: -114.7428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Fixed: Asym + R0 + lrc ~ 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Asym         R0        lrc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101.449600  -8.627331  -3.233751 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Random effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: Asym ~ 1 | Seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Asym  Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> StdDev: 3.650642 0.7188625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Observations: 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Groups: 14 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">age.</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">2</span>, to <span class="op">=</span> <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">newLL.301</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">age.</span>, Seed <span class="op">=</span> <span class="fl">301</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">newLL.329</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">age.</span>, Seed <span class="op">=</span> <span class="fl">329</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">p301</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">newLL.301</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Seed predict.fixed predict.Seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   301    -0.2843099   -0.1318218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   301     7.4263714    7.7197901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   301    14.5526398   14.9763077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   301    21.1387895   21.6828346</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   301    27.2257576   27.8810562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   301    32.8513783   33.6094982</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   301    38.0506184   38.9037665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   301    42.8557944   43.7967683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   301    47.2967734   48.3189165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  301    51.4011589   52.4983192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  301    55.1944622   56.3609540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  301    58.7002611   59.9308295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  301    61.9403462   63.2301347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  301    64.9348567   66.2793769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  301    67.7024054   69.0975089</span>
<span class="r-in"><span><span class="op">(</span><span class="va">p329</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">newLL.329</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Seed predict.fixed predict.Seed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   329    -0.2843099   -0.7061314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   329     7.4263714    6.6146994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   329    14.5526398   13.3806651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   329    21.1387895   19.6338204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   329    27.2257576   25.4130326</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   329    32.8513783   30.7542231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   329    38.0506184   35.6905906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   329    42.8557944   40.2528179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   329    47.2967734   44.4692619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  329    51.4011589   48.3661305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  329    55.1944622   51.9676451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  329    58.7002611   55.2961915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  329    61.9403462   58.3724586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  329    64.9348567   61.2155672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  329    67.7024054   63.8431892</span>
<span class="r-in"><span><span class="co">## Prediction are the same at level 0 :</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">p301</span><span class="op">[</span>,<span class="st">"predict.fixed"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          <span class="va">p329</span><span class="op">[</span>,<span class="st">"predict.fixed"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co">## and differ by the 'Seed' effect at level 1 :</span></span></span>
<span class="r-in"><span><span class="va">p301</span><span class="op">[</span>,<span class="st">"predict.Seed"</span><span class="op">]</span> <span class="op">-</span></span></span>
<span class="r-in"><span><span class="va">p329</span><span class="op">[</span>,<span class="st">"predict.Seed"</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.5743096 1.1050907 1.5956426 2.0490142 2.4680236 2.8552752 3.2131759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 3.5439504 3.8496546 4.1321888 4.3933089 4.6346380 4.8576761 5.0638096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 5.2543197</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by José Pinheiro, Douglas Bates, R Core Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

