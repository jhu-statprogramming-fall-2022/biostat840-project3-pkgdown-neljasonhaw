<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function fits a nonlinear model using generalized least
  squares. The errors are allowed to be correlated and/or have unequal
  variances."><title>Fit Nonlinear Model Using Generalized Least Squares — gnls • nlme</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.4/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Nonlinear Model Using Generalized Least Squares — gnls"><meta property="og:description" content="This function fits a nonlinear model using generalized least
  squares. The errors are allowed to be correlated and/or have unequal
  variances."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlme</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-160</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lme-example.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit Nonlinear Model Using Generalized Least Squares</h1>
      
      <div class="d-none name"><code>gnls.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fits a nonlinear model using generalized least
  squares. The errors are allowed to be correlated and/or have unequal
  variances.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre><code>gnls(model, data, params, start, correlation, weights, subset,
     na.action, naPattern, control, verbose)
&lt;!-- %\method{update}{gnls}(object, model, data, params, start, correlation,  --&gt;
&lt;!-- %       weights, subset, na.action, naPattern, control, verbose, \dots)  --&gt;</code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>a two-sided formula object describing the
    model, with the response on the left of a <code>~</code> operator and 
    a nonlinear expression involving parameters and covariates on the
    right. If <code>data</code> is given, all names used in the formula should
    be defined as parameters or variables in the data frame.</p></dd>
 
 <dt>data</dt>
<dd><p>an optional data frame containing the variables named in
   <code>model</code>, <code>correlation</code>, <code>weights</code>, 
   <code>subset</code>, and <code>naPattern</code>. By default the variables are 
   taken from the environment from which <code>gnls</code> is called.</p></dd>

 <dt>params</dt>
<dd><p>an optional two-sided linear formula of the form
   <code>p1+...+pn~x1+...+xm</code>, or list of two-sided formulas of the form
   <code>p1~x1+...+xm</code>, with possibly different models for each
   parameter. The <code>p1,...,pn</code> represent parameters included on the
   right hand side of <code>model</code> and <code>x1+...+xm</code> define a linear
   model for the parameters (when the left hand side of the formula
   contains several parameters, they are all assumed to follow the same
   linear model described by the right hand side expression). A <code>1</code>
   on the right hand side of the formula(s) indicates a single fixed
   effects for the corresponding parameter(s). By default, the
   parameters are obtained from the names of <code>start</code>.</p></dd>
 
 <dt>start</dt>
<dd><p>an optional named list, or numeric vector, with the
   initial values for the parameters in <code>model</code>. It can be omitted
   when a <code>selfStarting</code> function is used in <code>model</code>, in which
   case the starting estimates will be obtained from a single call to the
   <code>nls</code> function.</p></dd>

 <dt>correlation</dt>
<dd><p>an optional <code>corStruct</code> object describing the
   within-group correlation structure. See the documentation of
   <code>corClasses</code> for a description of the available <code>corStruct</code>
   classes. If a grouping variable is to be used, it must be specified
   in the <code>form</code> argument to the <code>corStruct</code>
   constructor. Defaults to <code>NULL</code>, corresponding to uncorrelated 
   errors.</p></dd>
  
 <dt>weights</dt>
<dd><p>an optional <code>varFunc</code> object or one-sided formula
   describing the within-group heteroscedasticity structure. If given as
   a formula, it is used as the argument to <code>varFixed</code>,
   corresponding to fixed variance weights. See the documentation on
   <code>varClasses</code> for a description of the available <code>varFunc</code>
   classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
   errors.</p></dd>
 
 <dt>subset</dt>
<dd><p>an optional expression indicating which subset of the rows of
   <code>data</code> should  be  used in the fit. This can be a logical
   vector, or a numeric vector indicating which observation numbers are
   to be included, or a  character  vector of the row names to be
   included.  All observations are included by default.</p></dd>

 <dt>na.action</dt>
<dd><p>a function that indicates what should happen when the
   data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
   <code>gnls</code> to print an error message and terminate if there are any
   incomplete observations.</p></dd>

 <dt>naPattern</dt>
<dd><p>an expression or formula object, specifying which returned
   values are to be regarded as missing.</p></dd>

 <dt>control</dt>
<dd><p>a list of control values for the estimation algorithm to
   replace the default values returned by the function <code>gnlsControl</code>.
   Defaults to an empty list.</p></dd>

 <dt>verbose</dt>
<dd><p>an optional logical value. If <code>TRUE</code> information on
   the evolution of the iterative algorithm is printed. Default is
   <code>FALSE</code>.</p></dd>

</dl><p><!-- % \item{\dots}{some methods for this generic require additional --></p>


<p><!-- %    arguments.  None are used in this method.}  --></p>


    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of class <code>gnls</code>, also inheriting from class <code>gls</code>,
  representing the nonlinear model fit. Generic functions such as</p>
<p></p>
<p><code>print</code>, <code>plot</code> and  <code>summary</code> have methods to show the
  results of the fit. See <code>gnlsObject</code> for the components of the
  fit. The functions <code>resid</code>, <code>coef</code>, and <code>fitted</code> can be
  used to extract some of its components.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>The different correlation structures available for the
 <code>correlation</code> argument are described in Box, G.E.P., Jenkins,
 G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
 W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
 B.D. (2002). The use of variance functions for linear 
 and nonlinear models is presented in detail in Carrol, R.J. and Rupert,
 D. (1988) and Davidian, M. and Giltinan, D.M. (1995).</p>
<p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
 Analysis: Forecasting and Control", 3rd Edition, Holden-Day.</p>
<p>Carrol, R.J. and Rupert, D. (1988) "Transformation and Weighting in
 Regression", Chapman and Hall.</p>
<p>Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
 for Repeated Measurement Data", Chapman and Hall.</p>
<p>Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
 "SAS Systems for Mixed Models", SAS Institute.</p>
<p>Venables, W.N. and Ripley, B.D. (2002) "Modern Applied Statistics with
 S", 4th Edition, Springer-Verlag.</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
 in S and S-PLUS", Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="corClasses.html">corClasses</a></code>,
  <code><a href="gnlsControl.html">gnlsControl</a></code>, <code><a href="gnlsObject.html">gnlsObject</a></code>,
  <code><a href="gnlsStruct.html">gnlsStruct</a></code>,
  <code><a href="predict.gnls.html">predict.gnls</a></code>,
  <code><a href="varClasses.html">varClasses</a></code>,
  <code><a href="varFunc.html">varFunc</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># variance increases with a power of the absolute fitted values</span></span></span>
<span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu">gnls</span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSlogis.html" class="external-link">SSlogis</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Asym</span>, <span class="va">xmid</span>, <span class="va">scal</span><span class="op">)</span>, <span class="va">Soybean</span>,</span></span>
<span class="r-in"><span>            weights <span class="op">=</span> <span class="fu"><a href="varPower.html">varPower</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized nonlinear least squares fit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: weight ~ SSlogis(Time, Asym, xmid, scal) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Data: Soybean </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        AIC    BIC    logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   983.7947 1003.9 -486.8974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variance function:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Structure: Power of variance covariate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Formula: ~fitted(.) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Parameter estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     power </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8815436 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Value Std.Error  t-value p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asym 17.35682 0.5226885 33.20682       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xmid 51.87232 0.5916820 87.66925       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scal  7.62053 0.1390958 54.78617       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Correlation: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Asym  xmid </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> xmid 0.787      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scal 0.485 0.842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standardized residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Min           Q1          Med           Q3          Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.309670601 -0.646844571 -0.004897042  0.498606011  4.986727045 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.3662752 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 412 total; 409 residual</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by José Pinheiro, Douglas Bates, R Core Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

