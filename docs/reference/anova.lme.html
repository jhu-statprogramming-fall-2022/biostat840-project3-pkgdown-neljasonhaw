<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="When only one fitted model object is present, a data frame with the
  numerator degrees of freedom, denominator degrees of
  freedom, F-values, and P-values for Wald tests for the terms in the
  model (when Terms and L are NULL), a combination
  of model terms (when Terms in not NULL), or linear
  combinations of the model coefficients (when L is not
  NULL).  Otherwise, when multiple fitted objects are being
  compared, a data frame with the degrees of freedom, the (restricted)
  log-likelihood, the Akaike Information Criterion (AIC), and the
  Bayesian Information Criterion (BIC) of each object is returned.  If
  test=TRUE, whenever two consecutive  objects have different
  number of degrees of freedom, a likelihood ratio statistic with the
  associated p-value is included in the returned data frame."><title>Compare Likelihoods of Fitted Objects — anova.lme • nlme</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.4/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare Likelihoods of Fitted Objects — anova.lme"><meta property="og:description" content="When only one fitted model object is present, a data frame with the
  numerator degrees of freedom, denominator degrees of
  freedom, F-values, and P-values for Wald tests for the terms in the
  model (when Terms and L are NULL), a combination
  of model terms (when Terms in not NULL), or linear
  combinations of the model coefficients (when L is not
  NULL).  Otherwise, when multiple fitted objects are being
  compared, a data frame with the degrees of freedom, the (restricted)
  log-likelihood, the Akaike Information Criterion (AIC), and the
  Bayesian Information Criterion (BIC) of each object is returned.  If
  test=TRUE, whenever two consecutive  objects have different
  number of degrees of freedom, a likelihood ratio statistic with the
  associated p-value is included in the returned data frame."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlme</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-160</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lme-example.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compare Likelihoods of Fitted Objects</h1>
      
      <div class="d-none name"><code>anova.lme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When only one fitted model object is present, a data frame with the
  numerator degrees of freedom, denominator degrees of
  freedom, F-values, and P-values for Wald tests for the terms in the
  model (when <code>Terms</code> and <code>L</code> are <code>NULL</code>), a combination
  of model terms (when <code>Terms</code> in not <code>NULL</code>), or linear
  combinations of the model coefficients (when <code>L</code> is not
  <code>NULL</code>).  Otherwise, when multiple fitted objects are being
  compared, a data frame with the degrees of freedom, the (restricted)
  log-likelihood, the Akaike Information Criterion (AIC), and the
  Bayesian Information Criterion (BIC) of each object is returned.  If
  <code>test=TRUE</code>, whenever two consecutive  objects have different
  number of degrees of freedom, a likelihood ratio statistic with the
  associated p-value is included in the returned data frame.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for lme</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">test</span>, <span class="va">type</span>, <span class="va">adjustSigma</span>, <span class="va">Terms</span>, <span class="va">L</span>, <span class="va">verbose</span><span class="op">)</span></span>
<span><span class="co"># S3 method for anova.lme</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">verbose</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an object inheriting from class <code>"<a href="lme.html">lme</a>"</code>,
   representing a fitted linear mixed-effects model.</p></dd>

 <dt>...</dt>
<dd><p>other optional fitted model objects inheriting from
   classes <code>"gls"</code>, <code>"gnls"</code>, <code>"lm"</code>, <code>"lme"</code>,
   <code>"lmList"</code>, <code>"nlme"</code>, <code>"nlsList"</code>, or <code>"nls"</code>.</p></dd>

 <dt>test</dt>
<dd><p>an optional logical value controlling whether likelihood
   ratio tests should be used to compare the fitted models represented
   by <code>object</code> and the objects in <code>...</code>.  Defaults to
   <code>TRUE</code>.</p></dd>

 <dt>type</dt>
<dd><p>an optional character string specifying the type of sum of
   squares to be used in F-tests for the terms in the model.  If
   <code>"sequential"</code>, the sequential sum of squares obtained by
   including the terms in the order they appear in the model is used;
   else, if <code>"marginal"</code>, the marginal sum of squares
   obtained by deleting a term from the model at a time is used.  This
   argument is only used when a single fitted object is passed to the
   function.  Partial matching of arguments is used, so only the first
   character needs to be provided.  Defaults to <code>"sequential"</code>.</p></dd>

 <dt>adjustSigma</dt>
<dd><p>an optional logical value.  If <code>TRUE</code> and the
   estimation method used to obtain <code>object</code> was maximum
   likelihood, the residual standard error is multiplied by
   \(\sqrt{n_{obs}/(n_{obs} - n_{par})}\),
   converting it to a REML-like estimate.  This argument is only used
   when a single fitted object is passed to the function.  Default is
   <code>TRUE</code>.</p></dd>

 <dt>Terms</dt>
<dd><p>an optional integer or character vector specifying which
   terms in the model should be jointly tested to be zero using a Wald
   F-test.  If given as a character vector, its elements must correspond
   to term names; else, if given as an integer vector, its elements must
   correspond to the order in which terms are included in the
   model.  This argument is only used when a single fitted object is
   passed to the function.  Default is <code>NULL</code>.</p></dd>

 <dt>L</dt>
<dd><p>an optional numeric vector or array specifying linear
   combinations of the coefficients in the model that should be tested
   to be zero.  If given as an array, its rows define the linear
   combinations to be tested.  If names are assigned to the vector
   elements (array columns), they must correspond to coefficients
   names and will be used to map the linear combination(s) to the
   coefficients; else, if no names are available, the vector elements
   (array columns) are assumed in the same order as the coefficients
   appear in the model.  This argument is only used when a single fitted
   object is passed to the function.  Default is <code>NULL</code>.</p></dd>

 <dt>x</dt>
<dd><p>an object inheriting from class <code>"anova.lme"</code></p></dd>

 <dt>verbose</dt>
<dd><p>an optional logical value.  If <code>TRUE</code>, the calling
   sequences for each fitted model object are printed with the rest of
   the output, being omitted if <code>verbose = FALSE</code>.  Defaults to
   <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a data frame inheriting from class <code>"anova.lme"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
  in S and S-PLUS", Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Likelihood comparisons are not meaningful for objects fit using
  restricted maximum likelihood and with different fixed effects.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gls.html">gls</a></code>, <code><a href="gnls.html">gnls</a></code>, <code><a href="nlme.html">nlme</a></code>,
  <code><a href="lme.html">lme</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></code>,
  <code>print.anova.lme</code>,
  <code><a href="logLik.lme.html">logLik.lme</a></code>,</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lme.html">lme</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="va">age</span>, <span class="va">Orthodont</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">age</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             numDF denDF   F-value p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     1    80 3096.4871  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age             1    80   85.8464  &lt;.0001</span>
<span class="r-in"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1</span>, random <span class="op">=</span> <span class="fu"><a href="pdDiag.html">pdDiag</a></span><span class="op">(</span><span class="op">~</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Model df      AIC      BIC    logLik   Test   L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm1     1  6 454.6367 470.6173 -221.3183                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm2     2  5 453.3146 466.6318 -221.6573 1 vs 2 0.6778943  0.4103</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pinheiro and Bates, pp. 251-254 ------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">fm1Orth.gls</span> <span class="op">&lt;-</span> <span class="fu"><a href="gls.html">gls</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="va">Sex</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">11</span><span class="op">)</span>, <span class="va">Orthodont</span>,</span></span>
<span class="r-in"><span>       correlation <span class="op">=</span> <span class="fu"><a href="corSymm.html">corSymm</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       weights <span class="op">=</span> <span class="fu"><a href="varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm2Orth.gls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1Orth.gls</span>,</span></span>
<span class="r-in"><span>          corr <span class="op">=</span> <span class="fu"><a href="corCompSymm.html">corCompSymm</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## anova.gls examples:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm1Orth.gls</span>, <span class="va">fm2Orth.gls</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm1Orth.gls     1 14 452.5468 489.5683 -212.2734                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm2Orth.gls     2  9 449.9724 473.7719 -215.9862 1 vs 2 7.425576  0.1909</span>
<span class="r-in"><span><span class="va">fm3Orth.gls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm2Orth.gls</span>, weights <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm2Orth.gls</span>, <span class="va">fm3Orth.gls</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm2Orth.gls     1  9 449.9724 473.7719 -215.9862                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm3Orth.gls     2  6 445.7572 461.6236 -216.8786 1 vs 2 1.784873  0.6182</span>
<span class="r-in"><span><span class="va">fm4Orth.gls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm3Orth.gls</span>, weights <span class="op">=</span> <span class="fu"><a href="varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm3Orth.gls</span>, <span class="va">fm4Orth.gls</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm3Orth.gls     1  6 445.7572 461.6236 -216.8786                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm4Orth.gls     2  7 436.1887 454.6994 -211.0943 1 vs 2 11.56859   7e-04</span>
<span class="r-in"><span><span class="co"># not in book but needed for the following command</span></span></span>
<span class="r-in"><span><span class="va">fm3Orth.lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="lme.html">lme</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">~</span> <span class="va">Sex</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">11</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Orthodont</span>,</span></span>
<span class="r-in"><span>                   random <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">age</span><span class="op">-</span><span class="fl">11</span><span class="op">)</span> <span class="op">|</span> <span class="va">Subject</span>,</span></span>
<span class="r-in"><span>                   weights <span class="op">=</span> <span class="fu"><a href="varIdent.html">varIdent</a></span><span class="op">(</span>form <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Compare an "lme" object with a "gls" object (test would be non-sensical!)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm3Orth.lme</span>, <span class="va">fm4Orth.gls</span>, test <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Model df      AIC      BIC    logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm3Orth.lme     1  9 429.5225 453.3220 -205.7612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm4Orth.gls     2  7 436.1887 454.6994 -211.0943</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pinheiro and Bates, pp. 222-225 ------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1BW.lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="lme.html">lme</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">*</span> <span class="va">Diet</span>, <span class="va">BodyWeight</span>, random <span class="op">=</span> <span class="op">~</span> <span class="va">Time</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm2BW.lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1BW.lme</span>, weights <span class="op">=</span> <span class="fu"><a href="varPower.html">varPower</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test a specific contrast</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm2BW.lme</span>, L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time:Diet2"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"Time:Diet3"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-test for linear combination(s)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time:Diet2 Time:Diet3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1         -1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   numDF denDF  F-value p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1   157 2.862569  0.0926</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pinheiro and Bates, pp. 352-365 ------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">fm1Theo.lis</span> <span class="op">&lt;-</span> <span class="fu"><a href="nlsList.html">nlsList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     <span class="va">conc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/SSfol.html" class="external-link">SSfol</a></span><span class="op">(</span><span class="va">Dose</span>, <span class="va">Time</span>, <span class="va">lKe</span>, <span class="va">lKa</span>, <span class="va">lCl</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Theoph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm1Theo.lis</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model: conc ~ SSfol(Dose, Time, lKe, lKa, lCl) | Subject </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Data: Theoph </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lKe        lKa       lCl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -2.307332  0.1516234 -2.973242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -2.280370 -0.3860511 -2.964335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -2.386437  0.3188339 -3.069111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 -2.321530  1.3478239 -2.860397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -2.508073  0.8975422 -3.229965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -2.286108  0.6640568 -3.106317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -2.436494  0.1582638 -3.286087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  -2.446088  2.1821879 -3.420774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 -2.248326 -0.1828442 -3.170158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -2.604148 -0.3631216 -3.428271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -2.919614  0.5751612 -3.915857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -2.425486  0.3862853 -3.132600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of freedom: 132 total; 96 residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.7001921</span>
<span class="r-in"><span><span class="va">fm1Theo.nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="nlme.html">nlme</a></span><span class="op">(</span><span class="va">fm1Theo.lis</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Iteration 2, LME step: nlminb() did not converge (code = 1). Do increase 'msMaxIter'!</span>
<span class="r-in"><span><span class="va">fm2Theo.nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm1Theo.nlme</span>, random<span class="op">=</span> <span class="fu"><a href="pdDiag.html">pdDiag</a></span><span class="op">(</span><span class="va">lKe</span><span class="op">+</span><span class="va">lKa</span><span class="op">+</span><span class="va">lCl</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fm3Theo.nlme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">fm2Theo.nlme</span>, random<span class="op">=</span> <span class="fu"><a href="pdDiag.html">pdDiag</a></span><span class="op">(</span>    <span class="va">lKa</span><span class="op">+</span><span class="va">lCl</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparing the 3 nlme models</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm1Theo.nlme</span>, <span class="va">fm3Theo.nlme</span>, <span class="va">fm2Theo.nlme</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm1Theo.nlme     1 10 366.6417 395.4697 -173.3208                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm3Theo.nlme     2  6 366.0429 383.3397 -177.0214 1 vs 2 7.401190  0.1161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fm2Theo.nlme     3  7 368.0470 388.2266 -177.0235 2 vs 3 0.004123  0.9488</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span> <span class="co"># (set back to previous state)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by José Pinheiro, Douglas Bates, R Core Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

