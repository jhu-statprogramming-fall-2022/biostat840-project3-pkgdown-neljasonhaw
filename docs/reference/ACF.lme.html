<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This method function calculates the empirical autocorrelation function
  for the within-group residuals from an lme fit. The
  autocorrelation values are calculated using pairs of residuals within
  the innermost group level. The autocorrelation function is  useful for
  investigating serial correlation models for equally spaced data."><title>Autocorrelation Function for lme Residuals — ACF.lme • nlme</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.4/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.4/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Autocorrelation Function for lme Residuals — ACF.lme"><meta property="og:description" content="This method function calculates the empirical autocorrelation function
  for the within-group residuals from an lme fit. The
  autocorrelation values are calculated using pairs of residuals within
  the innermost group level. The autocorrelation function is  useful for
  investigating serial correlation models for equally spaced data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nlme</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1-160</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/lme-example.html">Example Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Autocorrelation Function for lme Residuals</h1>
      
      <div class="d-none name"><code>ACF.lme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method function calculates the empirical autocorrelation function
  for the within-group residuals from an <code>lme</code> fit. The
  autocorrelation values are calculated using pairs of residuals within
  the innermost group level. The autocorrelation function is  useful for
  investigating serial correlation models for equally spaced data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for lme</span></span>
<span><span class="fu"><a href="ACF.html">ACF</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">maxLag</span>, <span class="va">resType</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>an object inheriting from class <code>"<a href="lme.html">lme</a>"</code>, representing
    a fitted linear mixed-effects model.</p></dd>

  <dt>maxLag</dt>
<dd><p>an optional integer giving the maximum lag for which the
    autocorrelation should be calculated. Defaults to maximum lag in the
    within-group residuals.</p></dd>
  
  <dt>resType</dt>
<dd><p>an optional character string specifying the type of
    residuals to be used. If <code>"response"</code>, the "raw" residuals
    (observed - fitted) are used; else, if <code>"pearson"</code>, the
    standardized residuals (raw residuals divided by the corresponding
    standard errors) are used; else, if <code>"normalized"</code>, the
    normalized residuals (standardized residuals pre-multiplied by the
    inverse square-root factor of the estimated error correlation
    matrix) are used. Partial matching of arguments is used, so only the
    first character needs to be provided. Defaults to <code>"pearson"</code>.</p></dd>
 
 <dt>...</dt>
<dd><p>some methods for this generic require additional
   arguments -- not used.</p></dd>
 
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a data frame with columns <code>lag</code> and <code>ACF</code> representing,
  respectively, the lag between residuals within a pair and the corresponding
  empirical autocorrelation. The returned value inherits from class</p>
<p></p>
<p><code>ACF</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
  Analysis: Forecasting and Control", 3rd Edition, Holden-Day.</p>
<p>Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
  in S and S-PLUS", Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>José Pinheiro and Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ACF.gls.html">ACF.gls</a></code>, <code><a href="plot.ACF.html">plot.ACF</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="lme.html">lme</a></span><span class="op">(</span><span class="va">follicles</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="va">Ovary</span>, random <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span> <span class="op">|</span> <span class="va">Mare</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ACF.html">ACF</a></span><span class="op">(</span><span class="va">fm1</span>, maxLag <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lag          ACF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0  1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1  0.380191824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    2  0.180089173</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3  0.036688753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4  0.059951162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    5  0.001916046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    6  0.063499044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    7  0.070979841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    8  0.049660461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   9  0.029428152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  10 -0.032162165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  11 -0.074003608</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pinheiro and Bates, p240-241</span></span></span>
<span class="r-in"><span><span class="va">fm1Over.lme</span> <span class="op">&lt;-</span> <span class="fu"><a href="lme.html">lme</a></span><span class="op">(</span><span class="va">follicles</span>  <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span>, data<span class="op">=</span><span class="va">Ovary</span>,</span></span>
<span class="r-in"><span>     random<span class="op">=</span><span class="fu"><a href="pdDiag.html">pdDiag</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">ACF.fm1Over</span> <span class="op">&lt;-</span> <span class="fu"><a href="ACF.html">ACF</a></span><span class="op">(</span><span class="va">fm1Over.lme</span>, maxLag<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lag          ACF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0  1.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    1  0.379480128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    2  0.179722025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    3  0.035692749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    4  0.059778881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    5  0.002096953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    6  0.064327101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    7  0.071634861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    8  0.048578247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   9  0.027782488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  10 -0.034275979</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ACF.fm1Over</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="ACF.lme-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by José Pinheiro, Douglas Bates, R Core Team.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

